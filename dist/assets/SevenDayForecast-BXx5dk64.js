import{k as q,j as e,l as J,m as T,n as K,o as C,O as P,D as O}from"./ui-BbEAuUw2.js";import{r as l}from"./vendor-CrRmGii_.js";import{G as Q}from"./glass-card-w_TbMZCU.js";import{b as f,X as V,C as Y,g as Z,d as _}from"./index-BydeStaf.js";import{u as E}from"./useUnitConversion-DpxUpf6s.js";import{W as S,D as W,C as F}from"./wind-CdDonkrz.js";import{f as ee}from"./utils-DzfkJJIA.js";import"./zustand-D4WnGny0.js";const te=q,ae=J,$=l.forwardRef(({className:a,...i},o)=>e.jsx(P,{ref:o,className:f("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...i}));$.displayName=P.displayName;const M=l.forwardRef(({className:a,children:i,...o},d)=>e.jsxs(ae,{children:[e.jsx($,{}),e.jsxs(T,{ref:d,className:f("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...o,children:[i,e.jsxs(K,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));M.displayName=T.displayName;const L=({className:a,...i})=>e.jsx("div",{className:f("flex flex-col space-y-1.5 text-center sm:text-left",a),...i});L.displayName="DialogHeader";const R=l.forwardRef(({className:a,...i},o)=>e.jsx(C,{ref:o,className:f("text-lg font-semibold leading-none tracking-tight",a),...i}));R.displayName=C.displayName;const se=l.forwardRef(({className:a,...i},o)=>e.jsx(O,{ref:o,className:f("text-sm text-muted-foreground",a),...i}));se.displayName=O.displayName;function re({period:a,open:i,onClose:o}){const{convertTemperature:d,convertWindSpeed:y}=E();if(!a)return null;const N=n=>d(n,"F").value,v=n=>{if(!n)return"N/A";const p=n.match(/(\d+)/);if(!p||!p[1])return n;const m=parseInt(p[1],10),g=y(m,"mph");return n.replace(/\d+/,g.value.toString()).replace("mph",g.unit)},j=n=>{try{return ee(new Date(n),"EEEE, MMM d, h:mm a")}catch{return n}},b=d(0,"F").unit==="F"?"째F":"째C",u=N(a.temperature);return e.jsx(te,{open:i,onOpenChange:o,children:e.jsxs(M,{className:"max-w-2xl max-h-[80vh] overflow-y-auto bg-white/20 dark:bg-black/30 backdrop-blur-2xl border border-white/30 dark:border-white/15 shadow-glass-lg","aria-describedby":"forecast-description",children:[e.jsx(L,{children:e.jsx(R,{className:"text-2xl text-white dark:text-gray-100",children:a.name})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("img",{src:a.icon,alt:a.shortForecast,className:"h-24 w-24"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-bold text-white dark:text-gray-100",children:[u,b]}),a.temperatureTrend&&e.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:["Trending ",a.temperatureTrend]}),e.jsx("div",{className:"mt-1 text-lg text-gray-900 dark:text-gray-100",children:a.shortForecast})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(S,{className:"h-5 w-5 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-100",children:"Wind"}),e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[a.windDirection," ",v(a.windSpeed)]})]})]}),a.probabilityOfPrecipitation?.value!==null&&a.probabilityOfPrecipitation?.value!==void 0&&e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(W,{className:"h-5 w-5 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-100",children:"Precipitation"}),e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[a.probabilityOfPrecipitation.value,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(F,{className:"h-5 w-5 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-100",children:"Day/Night"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:a.isDaytime?"Day":"Night"})]})]})]}),e.jsx("div",{className:"rounded-lg bg-muted p-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Time Period"}),e.jsxs("div",{className:"mt-1 text-gray-900 dark:text-gray-100",children:[j(a.startTime)," - ",j(a.endTime)]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-semibold text-white dark:text-gray-100",children:"Detailed Forecast"}),e.jsx("p",{id:"forecast-description",className:"text-sm leading-relaxed text-gray-900 dark:text-gray-100",children:a.detailedForecast})]})]})]})})}function pe({forecast:a}){const{convertTemperature:i,convertWindSpeed:o}=E(),[d,y]=l.useState(null),[N,v]=l.useState(!1),[j,b]=l.useState(!1),u=l.useRef(null),[n,p]=l.useState(null);l.useEffect(()=>{const t=()=>{const r=u.current;if(r){const c=r.scrollWidth>r.clientWidth,x=r.scrollWidth-r.scrollLeft<=r.clientWidth+10;b(c&&!x)}};t();const s=u.current;return s&&(s.addEventListener("scroll",t),window.addEventListener("resize",t)),()=>{s&&s.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[a]);const m=t=>i(t,"F").value,g=t=>{if(!t)return"N/A";const s=t.match(/(\d+)/);if(!s||!s[1])return t;const r=parseInt(s[1],10),c=o(r,"mph");return t.replace(/\d+/,c.value.toString()).replace("mph",c.unit)},k=[];for(let t=0;t<a.length;t++){const s=a[t];if(s&&s.isDaytime){const r=a[t+1];k.push({day:s,night:r&&!r.isDaytime?r:void 0}),r&&!r.isDaytime&&t++}}const z=k.slice(0,7),A=l.useCallback((t,s)=>{s&&p(s),y(t),v(!0)},[]),H=l.useCallback(()=>{v(!1),setTimeout(()=>{n?.focus()},0)},[n]),D=t=>t.replace(" Night","").replace(" Afternoon",""),h=i(0,"F").unit==="F"?"째F":"째C",I=(t,s)=>{const r=s===0?"Today":D(t.day.name),c=m(t.day.temperature),x=t.night?.temperature?m(t.night.temperature):null,B=x!==null?`High ${c}${h}, Low ${x}${h}`:`${c}${h}`,U=t.day.shortForecast,w=t.day.probabilityOfPrecipitation?.value,G=w!=null?`${w}% chance of precipitation`:null,X=`Wind ${t.day.windDirection} at ${g(t.day.windSpeed)}`;return[`${r}:`,B,U,G,X,"Click to view detailed forecast."].filter(Boolean).join(". ")};return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{blur:"lg",gradient:!0,interactive:!0,children:[e.jsx(Y,{children:e.jsx(Z,{className:"text-white dark:text-gray-100",children:"7-Day Forecast"})}),e.jsx(_,{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:u,className:"overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 pb-2",children:z.map((t,s)=>{const r=m(t.day.temperature),c=t.night?.temperature?m(t.night.temperature):void 0;return e.jsxs("button",{onClick:x=>A(t.day,x.currentTarget),className:"flex min-w-[140px] flex-col items-center gap-2 rounded-lg border p-4 transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","aria-label":I(t,s),children:[e.jsx("div",{className:"text-sm font-semibold",children:s===0?"Today":D(t.day.name)}),e.jsx("img",{src:t.day.icon,alt:"","aria-hidden":"true",className:"h-16 w-16"}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:t.day.shortForecast})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:[r,h]}),c!==void 0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[c,h]})]}),e.jsxs("div",{className:"w-full space-y-1 text-xs text-muted-foreground",children:[t.day.probabilityOfPrecipitation?.value!==null&&t.day.probabilityOfPrecipitation?.value!==void 0&&e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(W,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{children:[t.day.probabilityOfPrecipitation.value,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(S,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{className:"text-[10px]",children:[t.day.windDirection," ",g(t.day.windSpeed)]})]})]})]},t.day.number)})})}),j&&e.jsx("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-16 bg-gradient-to-l from-card to-transparent"})]})})]}),e.jsx(re,{period:d,open:N,onClose:H})]})}export{pe as SevenDayForecast};

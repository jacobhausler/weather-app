import{k as q,j as e,l as J,m as T,n as K,o as C,O as P,D as O}from"./ui-BbEAuUw2.js";import{r as l}from"./vendor-CrRmGii_.js";import{G as Q}from"./glass-card-I8N4qm4k.js";import{b as f,X as V,C as Y,g as Z,d as _}from"./index-SGL460h1.js";import{u as W}from"./useUnitConversion-DpxUpf6s.js";import{W as E,a as S,D as $,C as ee}from"./WeatherIcon-Fa1FEMQ_.js";import{f as te}from"./utils-DzfkJJIA.js";import"./zustand-D4WnGny0.js";const se=q,ae=J,z=l.forwardRef(({className:s,...n},o)=>e.jsx(P,{ref:o,className:f("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...n}));z.displayName=P.displayName;const M=l.forwardRef(({className:s,children:n,...o},d)=>e.jsxs(ae,{children:[e.jsx(z,{}),e.jsxs(T,{ref:d,className:f("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...o,children:[n,e.jsxs(K,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));M.displayName=T.displayName;const I=({className:s,...n})=>e.jsx("div",{className:f("flex flex-col space-y-1.5 text-center sm:text-left",s),...n});I.displayName="DialogHeader";const L=l.forwardRef(({className:s,...n},o)=>e.jsx(C,{ref:o,className:f("text-lg font-semibold leading-none tracking-tight",s),...n}));L.displayName=C.displayName;const re=l.forwardRef(({className:s,...n},o)=>e.jsx(O,{ref:o,className:f("text-sm text-muted-foreground",s),...n}));re.displayName=O.displayName;function ne({period:s,open:n,onClose:o}){const{convertTemperature:d,convertWindSpeed:y}=W();if(!s)return null;const N=i=>d(i,"F").value,v=i=>{if(!i)return"N/A";const p=i.match(/(\d+)/);if(!p||!p[1])return i;const m=parseInt(p[1],10),h=y(m,"mph");return i.replace(/\d+/,h.value.toString()).replace("mph",h.unit)},j=i=>{try{return te(new Date(i),"EEEE, MMM d, h:mm a")}catch{return i}},b=d(0,"F").unit==="F"?"째F":"째C",u=N(s.temperature);return e.jsx(se,{open:n,onOpenChange:o,children:e.jsxs(M,{className:"max-w-2xl max-h-[80vh] overflow-y-auto bg-white/20 dark:bg-black/30 backdrop-blur-2xl border border-white/30 dark:border-white/15 shadow-glass-lg","aria-describedby":"forecast-description",children:[e.jsx(I,{children:e.jsx(L,{className:"text-2xl text-white dark:text-gray-100",children:s.name})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx(E,{nwsIconUrl:s.icon,shortForecast:s.shortForecast,size:"lg",className:"h-24 w-24"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-bold text-white dark:text-gray-100",children:[u,b]}),s.temperatureTrend&&e.jsxs("div",{className:"text-sm text-gray-900 dark:text-gray-100",children:["Trending ",s.temperatureTrend]}),e.jsx("div",{className:"mt-1 text-lg text-gray-900 dark:text-gray-100",children:s.shortForecast})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(S,{className:"h-5 w-5 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-100",children:"Wind"}),e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[s.windDirection," ",v(s.windSpeed)]})]})]}),s.probabilityOfPrecipitation?.value!==null&&s.probabilityOfPrecipitation?.value!==void 0&&e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx($,{className:"h-5 w-5 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-100",children:"Precipitation"}),e.jsxs("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:[s.probabilityOfPrecipitation.value,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(ee,{className:"h-5 w-5 text-gray-900 dark:text-gray-100"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-gray-900 dark:text-gray-100",children:"Day/Night"}),e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:s.isDaytime?"Day":"Night"})]})]})]}),e.jsx("div",{className:"rounded-lg bg-muted p-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900 dark:text-gray-100",children:"Time Period"}),e.jsxs("div",{className:"mt-1 text-gray-900 dark:text-gray-100",children:[j(s.startTime)," - ",j(s.endTime)]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-semibold text-white dark:text-gray-100",children:"Detailed Forecast"}),e.jsx("p",{id:"forecast-description",className:"text-sm leading-relaxed text-gray-900 dark:text-gray-100",children:s.detailedForecast})]})]})]})})}function he({forecast:s}){const{convertTemperature:n,convertWindSpeed:o}=W(),[d,y]=l.useState(null),[N,v]=l.useState(!1),[j,b]=l.useState(!1),u=l.useRef(null),[i,p]=l.useState(null);l.useEffect(()=>{const t=()=>{const r=u.current;if(r){const c=r.scrollWidth>r.clientWidth,x=r.scrollWidth-r.scrollLeft<=r.clientWidth+10;b(c&&!x)}};t();const a=u.current;return a&&(a.addEventListener("scroll",t),window.addEventListener("resize",t)),()=>{a&&a.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[s]);const m=t=>n(t,"F").value,h=t=>{if(!t)return"N/A";const a=t.match(/(\d+)/);if(!a||!a[1])return t;const r=parseInt(a[1],10),c=o(r,"mph");return t.replace(/\d+/,c.value.toString()).replace("mph",c.unit)},k=[];for(let t=0;t<s.length;t++){const a=s[t];if(a&&a.isDaytime){const r=s[t+1];k.push({day:a,night:r&&!r.isDaytime?r:void 0}),r&&!r.isDaytime&&t++}}const R=k.slice(0,7),U=l.useCallback((t,a)=>{a&&p(a),y(t),v(!0)},[]),A=l.useCallback(()=>{v(!1),setTimeout(()=>{i?.focus()},0)},[i]),D=t=>t.replace(" Night","").replace(" Afternoon",""),g=n(0,"F").unit==="F"?"째F":"째C",H=(t,a)=>{const r=a===0?"Today":D(t.day.name),c=m(t.day.temperature),x=t.night?.temperature?m(t.night.temperature):null,B=x!==null?`High ${c}${g}, Low ${x}${g}`:`${c}${g}`,G=t.day.shortForecast,w=t.day.probabilityOfPrecipitation?.value,F=w!=null?`${w}% chance of precipitation`:null,X=`Wind ${t.day.windDirection} at ${h(t.day.windSpeed)}`;return[`${r}:`,B,G,F,X,"Click to view detailed forecast."].filter(Boolean).join(". ")};return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{blur:"lg",gradient:!0,interactive:!0,children:[e.jsx(Y,{children:e.jsx(Z,{className:"text-white dark:text-gray-100",children:"7-Day Forecast"})}),e.jsx(_,{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:u,className:"overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 pb-2",children:R.map((t,a)=>{const r=m(t.day.temperature),c=t.night?.temperature?m(t.night.temperature):void 0;return e.jsxs("button",{onClick:x=>U(t.day,x.currentTarget),className:"flex min-w-[140px] flex-col items-center gap-2 rounded-lg border p-4 transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","aria-label":H(t,a),children:[e.jsx("div",{className:"text-sm font-semibold",children:a===0?"Today":D(t.day.name)}),e.jsx(E,{nwsIconUrl:t.day.icon,shortForecast:t.day.shortForecast,size:"md",className:"h-16 w-16"}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:t.day.shortForecast})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:[r,g]}),c!==void 0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[c,g]})]}),e.jsxs("div",{className:"w-full space-y-1 text-xs text-muted-foreground",children:[t.day.probabilityOfPrecipitation?.value!==null&&t.day.probabilityOfPrecipitation?.value!==void 0&&e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx($,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{children:[t.day.probabilityOfPrecipitation.value,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(S,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{className:"text-[10px]",children:[t.day.windDirection," ",h(t.day.windSpeed)]})]})]})]},t.day.number)})})}),j&&e.jsx("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-16 bg-gradient-to-l from-card to-transparent"})]})})]}),e.jsx(ne,{period:d,open:N,onClose:A})]})}export{he as SevenDayForecast};

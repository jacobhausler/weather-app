import{k as G,j as e,l as J,m as C,n as K,o as P,O,D as E}from"./ui-BbEAuUw2.js";import{r as o}from"./vendor-CrRmGii_.js";import{b as g,X as Q,C as V,d as Y,f as Z,e as _}from"./index-CSWJw8QM.js";import{u as S}from"./useUnitConversion-DpxUpf6s.js";import{W,D as k,C as F}from"./wind-DNUO8vXL.js";import{f as ee}from"./utils-DzfkJJIA.js";import"./zustand-D4WnGny0.js";const te=G,se=J,$=o.forwardRef(({className:s,...i},l)=>e.jsx(O,{ref:l,className:g("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",s),...i}));$.displayName=O.displayName;const M=o.forwardRef(({className:s,children:i,...l},d)=>e.jsxs(se,{children:[e.jsx($,{}),e.jsxs(C,{ref:d,className:g("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",s),...l,children:[i,e.jsxs(K,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));M.displayName=C.displayName;const L=({className:s,...i})=>e.jsx("div",{className:g("flex flex-col space-y-1.5 text-center sm:text-left",s),...i});L.displayName="DialogHeader";const R=o.forwardRef(({className:s,...i},l)=>e.jsx(P,{ref:l,className:g("text-lg font-semibold leading-none tracking-tight",s),...i}));R.displayName=P.displayName;const ae=o.forwardRef(({className:s,...i},l)=>e.jsx(E,{ref:l,className:g("text-sm text-muted-foreground",s),...i}));ae.displayName=E.displayName;function ne({period:s,open:i,onClose:l}){const{convertTemperature:d,convertWindSpeed:N}=S();if(!s)return null;const b=r=>d(r,"F").value,v=r=>{if(!r)return"N/A";const p=r.match(/(\d+)/);if(!p||!p[1])return r;const m=parseInt(p[1],10),f=N(m,"mph");return r.replace(/\d+/,f.value.toString()).replace("mph",f.unit)},j=r=>{try{return ee(new Date(r),"EEEE, MMM d, h:mm a")}catch{return r}},y=d(0,"F").unit==="F"?"째F":"째C",x=b(s.temperature);return e.jsx(te,{open:i,onOpenChange:l,children:e.jsxs(M,{className:"max-w-2xl max-h-[80vh] overflow-y-auto","aria-describedby":"forecast-description",children:[e.jsx(L,{children:e.jsx(R,{className:"text-2xl",children:s.name})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsx("img",{src:s.icon,alt:s.shortForecast,className:"h-24 w-24"}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-4xl font-bold",children:[x,y]}),s.temperatureTrend&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Trending ",s.temperatureTrend]}),e.jsx("div",{className:"mt-1 text-lg text-muted-foreground",children:s.shortForecast})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(W,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Wind"}),e.jsxs("div",{className:"font-medium",children:[s.windDirection," ",v(s.windSpeed)]})]})]}),s.probabilityOfPrecipitation?.value!==null&&s.probabilityOfPrecipitation?.value!==void 0&&e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(k,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Precipitation"}),e.jsxs("div",{className:"font-medium",children:[s.probabilityOfPrecipitation.value,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 rounded-lg border p-3",children:[e.jsx(F,{className:"h-5 w-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-muted-foreground",children:"Day/Night"}),e.jsx("div",{className:"font-medium",children:s.isDaytime?"Day":"Night"})]})]})]}),e.jsx("div",{className:"rounded-lg bg-muted p-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium",children:"Time Period"}),e.jsxs("div",{className:"mt-1 text-muted-foreground",children:[j(s.startTime)," - ",j(s.endTime)]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"mb-2 font-semibold",children:"Detailed Forecast"}),e.jsx("p",{id:"forecast-description",className:"text-sm leading-relaxed text-muted-foreground",children:s.detailedForecast})]})]})]})})}function xe({forecast:s}){const{convertTemperature:i,convertWindSpeed:l}=S(),[d,N]=o.useState(null),[b,v]=o.useState(!1),[j,y]=o.useState(!1),x=o.useRef(null),[r,p]=o.useState(null);o.useEffect(()=>{const t=()=>{const n=x.current;if(n){const c=n.scrollWidth>n.clientWidth,u=n.scrollWidth-n.scrollLeft<=n.clientWidth+10;y(c&&!u)}};t();const a=x.current;return a&&(a.addEventListener("scroll",t),window.addEventListener("resize",t)),()=>{a&&a.removeEventListener("scroll",t),window.removeEventListener("resize",t)}},[s]);const m=t=>i(t,"F").value,f=t=>{if(!t)return"N/A";const a=t.match(/(\d+)/);if(!a||!a[1])return t;const n=parseInt(a[1],10),c=l(n,"mph");return t.replace(/\d+/,c.value.toString()).replace("mph",c.unit)},D=[];for(let t=0;t<s.length;t++){const a=s[t];if(a&&a.isDaytime){const n=s[t+1];D.push({day:a,night:n&&!n.isDaytime?n:void 0}),n&&!n.isDaytime&&t++}}const z=D.slice(0,7),A=o.useCallback((t,a)=>{a&&p(a),N(t),v(!0)},[]),H=o.useCallback(()=>{v(!1),setTimeout(()=>{r?.focus()},0)},[r]),T=t=>t.replace(" Night","").replace(" Afternoon",""),h=i(0,"F").unit==="F"?"째F":"째C",I=(t,a)=>{const n=a===0?"Today":T(t.day.name),c=m(t.day.temperature),u=t.night?.temperature?m(t.night.temperature):null,B=u!==null?`High ${c}${h}, Low ${u}${h}`:`${c}${h}`,U=t.day.shortForecast,w=t.day.probabilityOfPrecipitation?.value,X=w!=null?`${w}% chance of precipitation`:null,q=`Wind ${t.day.windDirection} at ${f(t.day.windSpeed)}`;return[`${n}:`,B,U,X,q,"Click to view detailed forecast."].filter(Boolean).join(". ")};return e.jsxs(e.Fragment,{children:[e.jsxs(V,{children:[e.jsx(Y,{children:e.jsx(Z,{children:"7-Day Forecast"})}),e.jsx(_,{children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{ref:x,className:"overflow-x-auto",children:e.jsx("div",{className:"flex gap-4 pb-2",children:z.map((t,a)=>{const n=m(t.day.temperature),c=t.night?.temperature?m(t.night.temperature):void 0;return e.jsxs("button",{onClick:u=>A(t.day,u.currentTarget),className:"flex min-w-[140px] flex-col items-center gap-2 rounded-lg border p-4 transition-colors hover:bg-muted focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","aria-label":I(t,a),children:[e.jsx("div",{className:"text-sm font-semibold",children:a===0?"Today":T(t.day.name)}),e.jsx("img",{src:t.day.icon,alt:"","aria-hidden":"true",className:"h-16 w-16"}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-xs text-muted-foreground",children:t.day.shortForecast})}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-lg font-bold",children:[n,h]}),c!==void 0&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:[c,h]})]}),e.jsxs("div",{className:"w-full space-y-1 text-xs text-muted-foreground",children:[t.day.probabilityOfPrecipitation?.value!==null&&t.day.probabilityOfPrecipitation?.value!==void 0&&e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(k,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{children:[t.day.probabilityOfPrecipitation.value,"%"]})]}),e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(W,{className:"h-3 w-3","aria-hidden":"true"}),e.jsxs("span",{className:"text-[10px]",children:[t.day.windDirection," ",f(t.day.windSpeed)]})]})]})]},t.day.number)})})}),j&&e.jsx("div",{className:"pointer-events-none absolute right-0 top-0 h-full w-16 bg-gradient-to-l from-card to-transparent"})]})})]}),e.jsx(ne,{period:d,open:b,onClose:H})]})}export{xe as SevenDayForecast};
